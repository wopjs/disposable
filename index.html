<!DOCTYPE html><html class="default" lang="en" data-base="./"><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>@wopjs/disposable - v0.1.19</title><meta name="description" content="Documentation for @wopjs/disposable"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><link rel="stylesheet" href="assets/custom.css"/><script defer src="assets/main.js"></script><script async src="assets/icons.js" id="tsd-icons-script"></script><script async src="assets/search.js" id="tsd-search-script"></script><script async src="assets/navigation.js" id="tsd-nav-script"></script><script async src="assets/hierarchy.js" id="tsd-hierarchy-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => window.app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><a href="index.html" class="title">@wopjs/disposable - v0.1.19</a><div id="tsd-toolbar-links"></div><button id="tsd-search-trigger" class="tsd-widget" aria-label="Search"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-search"></use></svg></button><dialog id="tsd-search" aria-label="Search"><input role="combobox" id="tsd-search-input" aria-controls="tsd-search-results" aria-autocomplete="list" aria-expanded="true" autocapitalize="off" autocomplete="off" placeholder="Search the docs" maxLength="100"/><ul role="listbox" id="tsd-search-results"></ul><div id="tsd-search-status" aria-live="polite" aria-atomic="true"><div>Preparing search index...</div></div></dialog><a href="#" class="tsd-widget menu" id="tsd-toolbar-menu-trigger" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-menu"></use></svg></a></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><h1>@wopjs/disposable - v0.1.19</h1></div><div class="tsd-panel tsd-typography"><h1 id="wopjsdisposable" class="tsd-anchor-link">@wopjs/disposable<a href="#wopjsdisposable" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><p align="center">
  <img width="200" src="https://raw.githubusercontent.com/wopjs/disposable/main/assets/disposable.svg">
</p>
<p><a href="https://wopjs.github.io/disposable"><img src="https://img.shields.io/badge/Docs-read-%23fdf9f5" alt="Docs"></a>
<a href="https://github.com/wopjs/disposable/actions/workflows/build.yml"><img src="https://github.com/wopjs/disposable/actions/workflows/build.yml/badge.svg" alt="Build Status"></a>
<a href="https://www.npmjs.com/package/@wopjs/disposable"><img src="https://img.shields.io/npm/v/@wopjs/disposable.svg" alt="npm-version"></a>
<a href="https://coveralls.io/github/wopjs/disposable"><img src="https://img.shields.io/coverallsCoverage/github/wopjs/disposable" alt="Coverage Status"></a>
<a href="https://bundlephobia.com/package/@wopjs/disposable"><img src="https://img.shields.io/bundlephobia/minzip/@wopjs/disposable" alt="minified-size"></a>
<a href="https://bundlejs.com/?q=@wopjs/disposable&amp;treeshake=%5B%7BdisposableStore%7D%5D"><img src="https://img.shields.io/bundlejs/size/%40wopjs%2Fdisposable?exports=disposableStore&amp;label=core%20size" alt="core-size"></a></p>
<p>Manage side effect disposers in a compact, reusable and testable style. Designed and implemented with efficiency and ergonomics in mind.</p>
<h2 id="install" class="tsd-anchor-link">Install<a href="#install" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><pre><code><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-0">add</span><span class="hl-1"> @</span><span class="hl-0">wopjs</span><span class="hl-1">/</span><span class="hl-0">disposable</span>
</code><button>Copy</button></pre>

<h2 id="examples" class="tsd-anchor-link">Examples<a href="#examples" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><pre><code class="ts"><span class="hl-2">import</span><span class="hl-1"> { </span><span class="hl-0">disposableStore</span><span class="hl-1"> } </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&quot;@wopjs/disposable&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">// Example lib that returns a disposer function</span><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">listen</span><span class="hl-1"> = (</span><span class="hl-0">target</span><span class="hl-1">, </span><span class="hl-0">type</span><span class="hl-1">, </span><span class="hl-0">listener</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">target</span><span class="hl-1">.</span><span class="hl-6">addEventListener</span><span class="hl-1">(</span><span class="hl-0">type</span><span class="hl-1">, </span><span class="hl-0">listener</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-2">return</span><span class="hl-1"> () </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-0">target</span><span class="hl-1">.</span><span class="hl-6">removeEventListener</span><span class="hl-1">(</span><span class="hl-0">type</span><span class="hl-1">, </span><span class="hl-0">listener</span><span class="hl-1">);</span><br/><span class="hl-1">};</span><br/><br/><span class="hl-5">class</span><span class="hl-1"> </span><span class="hl-7">A</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">dispose</span><span class="hl-1"> = </span><span class="hl-6">disposableStore</span><span class="hl-1">();</span><br/><span class="hl-1">  </span><span class="hl-5">constructor</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-5">this</span><span class="hl-1">.</span><span class="hl-0">dispose</span><span class="hl-1">.</span><span class="hl-6">add</span><span class="hl-1">(</span><span class="hl-6">listen</span><span class="hl-1">(</span><span class="hl-3">&quot;type&quot;</span><span class="hl-1">, </span><span class="hl-0">event</span><span class="hl-1"> </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-0">event</span><span class="hl-1">)));</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">  </span><span class="hl-6">print</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">&quot;print a&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">class</span><span class="hl-1"> </span><span class="hl-7">B</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">dispose</span><span class="hl-1"> = </span><span class="hl-6">disposableStore</span><span class="hl-1">();</span><br/><span class="hl-1">  </span><span class="hl-4">// A is a disposable so it can be added to the store.</span><br/><span class="hl-1">  </span><span class="hl-0">a</span><span class="hl-1"> = </span><span class="hl-5">this</span><span class="hl-1">.</span><span class="hl-0">dispose</span><span class="hl-1">.</span><span class="hl-6">add</span><span class="hl-1">(</span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-6">A</span><span class="hl-1">());</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-8">b</span><span class="hl-1"> = </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-6">B</span><span class="hl-1">();</span><br/><span class="hl-0">b</span><span class="hl-1">.</span><span class="hl-0">a</span><span class="hl-1">.</span><span class="hl-6">print</span><span class="hl-1">(); </span><span class="hl-4">// &quot;print a&quot;</span><br/><span class="hl-0">b</span><span class="hl-1">.</span><span class="hl-6">dispose</span><span class="hl-1">(); </span><span class="hl-4">// both a and b are disposed</span>
</code><button type="button">Copy</button></pre>

<p>With more type annotations:</p>
<pre><code class="ts"><span class="hl-2">import</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">disposableStore</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">disposableMap</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-2">type</span><span class="hl-1"> </span><span class="hl-0">IDisposable</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-2">type</span><span class="hl-1"> </span><span class="hl-0">DisposableStore</span><span class="hl-1">,</span><br/><span class="hl-1">} </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&quot;@wopjs/disposable&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">// Example lib that returns a disposer function</span><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">listen</span><span class="hl-1"> = (</span><span class="hl-0">target</span><span class="hl-1">, </span><span class="hl-0">type</span><span class="hl-1">, </span><span class="hl-0">listener</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">target</span><span class="hl-1">.</span><span class="hl-6">addEventListener</span><span class="hl-1">(</span><span class="hl-0">type</span><span class="hl-1">, </span><span class="hl-0">listener</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-2">return</span><span class="hl-1"> () </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-0">target</span><span class="hl-1">.</span><span class="hl-6">removeEventListener</span><span class="hl-1">(</span><span class="hl-0">type</span><span class="hl-1">, </span><span class="hl-0">listener</span><span class="hl-1">);</span><br/><span class="hl-1">};</span><br/><br/><span class="hl-5">class</span><span class="hl-1"> </span><span class="hl-7">A</span><span class="hl-1"> </span><span class="hl-5">implements</span><span class="hl-1"> </span><span class="hl-7">IDisposable</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">dispose</span><span class="hl-1"> = </span><span class="hl-6">disposableMap</span><span class="hl-1">();</span><br/><span class="hl-1">  </span><span class="hl-6">someMethod</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-4">// Create side effects on demand.</span><br/><span class="hl-1">    </span><span class="hl-5">this</span><span class="hl-1">.</span><span class="hl-0">dispose</span><span class="hl-1">.</span><span class="hl-6">make</span><span class="hl-1">(</span><br/><span class="hl-1">      </span><span class="hl-4">// Easily implements debounce by providing a id for the disposer.</span><br/><span class="hl-1">      </span><span class="hl-4">// When adding disposer with the same id to the store, the previous disposer will be disposed.</span><br/><span class="hl-1">      </span><span class="hl-3">&quot;myIdForThisDebounce&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">      () </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-8">timeoutId</span><span class="hl-1"> = </span><span class="hl-6">setTimeout</span><span class="hl-1">(() </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">&quot;timeout&quot;</span><span class="hl-1">), </span><span class="hl-9">1000</span><span class="hl-1">);</span><br/><span class="hl-1">        </span><span class="hl-2">return</span><span class="hl-1"> () </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-6">clearTimeout</span><span class="hl-1">(</span><span class="hl-0">timeoutId</span><span class="hl-1">);</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    );</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">class</span><span class="hl-1"> </span><span class="hl-7">B</span><span class="hl-1"> </span><span class="hl-5">implements</span><span class="hl-1"> </span><span class="hl-7">IDisposable</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">dispose</span><span class="hl-1">: </span><span class="hl-7">DisposableStore</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-0">a</span><span class="hl-1"> = </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-6">A</span><span class="hl-1">();</span><br/><span class="hl-1">  </span><span class="hl-5">constructor</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-4">// Add initial disposables.</span><br/><span class="hl-1">    </span><span class="hl-5">this</span><span class="hl-1">.</span><span class="hl-0">dispose</span><span class="hl-1"> = </span><span class="hl-6">disposableStore</span><span class="hl-1">([</span><br/><span class="hl-1">      </span><span class="hl-4">// A is a disposable so it can be added to the store.</span><br/><span class="hl-1">      </span><span class="hl-0">a</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">// Add a disposer function.</span><br/><span class="hl-1">      </span><span class="hl-6">listen</span><span class="hl-1">(</span><span class="hl-3">&quot;type&quot;</span><span class="hl-1">, </span><span class="hl-0">event</span><span class="hl-1"> </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-0">event</span><span class="hl-1">)),</span><br/><span class="hl-1">    ]);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-8">b</span><span class="hl-1"> = </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-6">B</span><span class="hl-1">();</span><br/><span class="hl-0">b</span><span class="hl-1">.</span><span class="hl-6">dispose</span><span class="hl-1">(); </span><span class="hl-4">// All side effects in both a and b are disposed</span>
</code><button type="button">Copy</button></pre>

<h2 id="features" class="tsd-anchor-link">Features<a href="#features" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><h3 id="non-invasive" class="tsd-anchor-link">Non-invasive<a href="#non-invasive" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><ul>
<li>
<p>Disposable adopts both disposer function <code>() =&gt; void</code> and disposable <code>.dispose()</code> contracts which are widely accepted. Implementing these patterns does not require any extra effort.</p>
<pre><code class="js"><span class="hl-4">// disposer function pattern</span><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">disposer</span><span class="hl-1"> = () </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">&quot;dispose&quot;</span><span class="hl-1">);</span><br/><br/><span class="hl-4">// class disposable pattern</span><br/><span class="hl-5">class</span><span class="hl-1"> </span><span class="hl-7">MyDisposable</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-6">dispose</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">&quot;dispose&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-8">myDisposable</span><span class="hl-1"> = </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-6">MyDisposable</span><span class="hl-1">();</span><br/><br/><span class="hl-4">// plain object disposable pattern</span><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-8">myDisposable</span><span class="hl-1"> = {</span><br/><span class="hl-1">  </span><span class="hl-6">dispose</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">&quot;dispose&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">};</span>
</code><button type="button">Copy</button></pre>

</li>
<li>
<p>And of course it works well with other <code>@wopjs</code> libraries.</p>
<pre><code class="js"><span class="hl-2">import</span><span class="hl-1"> { </span><span class="hl-0">addEventListener</span><span class="hl-1"> } </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&quot;wopjs/dom&quot;</span><span class="hl-1">;</span><br/><span class="hl-2">import</span><span class="hl-1"> { </span><span class="hl-0">timeout</span><span class="hl-1"> } </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&quot;wopjs/time&quot;</span><span class="hl-1">;</span>
</code><button type="button">Copy</button></pre>

</li>
</ul>
<h3 id="compact" class="tsd-anchor-link">Compact<a href="#compact" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><ul>
<li>
<p>Disposables are designed to be composable and chainable.</p>
<pre><code class="ts"><span class="hl-2">import</span><span class="hl-1"> { </span><span class="hl-0">disposableStore</span><span class="hl-1">, </span><span class="hl-2">type</span><span class="hl-1"> </span><span class="hl-0">IDisposable</span><span class="hl-1"> } </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&quot;@wopjs/disposable&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">class</span><span class="hl-1"> </span><span class="hl-7">A</span><span class="hl-1"> </span><span class="hl-5">implements</span><span class="hl-1"> </span><span class="hl-7">IDisposable</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">dispose</span><span class="hl-1"> = </span><span class="hl-6">disposableStore</span><span class="hl-1">();</span><br/><span class="hl-1">  </span><span class="hl-5">constructor</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-5">this</span><span class="hl-1">.</span><span class="hl-0">dispose</span><span class="hl-1">.</span><span class="hl-6">add</span><span class="hl-1">(() </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">&quot;a&quot;</span><span class="hl-1">));</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">  </span><span class="hl-6">print</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">&quot;print a&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">class</span><span class="hl-1"> </span><span class="hl-7">B</span><span class="hl-1"> </span><span class="hl-5">implements</span><span class="hl-1"> </span><span class="hl-7">IDisposable</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">dispose</span><span class="hl-1"> = </span><span class="hl-6">disposableStore</span><span class="hl-1">();</span><br/><span class="hl-1">  </span><span class="hl-0">a</span><span class="hl-1"> = </span><span class="hl-5">this</span><span class="hl-1">.</span><span class="hl-0">dispose</span><span class="hl-1">.</span><span class="hl-6">add</span><span class="hl-1">(</span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-6">A</span><span class="hl-1">());</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-8">b</span><span class="hl-1"> = </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-6">B</span><span class="hl-1">();</span><br/><span class="hl-0">b</span><span class="hl-1">.</span><span class="hl-0">a</span><span class="hl-1">.</span><span class="hl-6">print</span><span class="hl-1">(); </span><span class="hl-4">// &quot;print a&quot;</span><br/><span class="hl-0">b</span><span class="hl-1">.</span><span class="hl-6">dispose</span><span class="hl-1">(); </span><span class="hl-4">// both a and b are disposed</span>
</code><button type="button">Copy</button></pre>

</li>
<li>
<p>You can also create your own side effects in a compact way.</p>
<pre><code class="js"><span class="hl-2">import</span><span class="hl-1"> { </span><span class="hl-0">disposableStore</span><span class="hl-1"> } </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&quot;@wopjs/disposable&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">class</span><span class="hl-1"> </span><span class="hl-7">A</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">dispose</span><span class="hl-1"> = </span><span class="hl-6">disposableStore</span><span class="hl-1">();</span><br/><span class="hl-1">  </span><span class="hl-5">constructor</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-0">dispose</span><span class="hl-1">.</span><span class="hl-6">make</span><span class="hl-1">(() </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">handler</span><span class="hl-1"> = () </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">&quot;click&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-0">someEvent</span><span class="hl-1">.</span><span class="hl-6">on</span><span class="hl-1">(</span><span class="hl-3">&quot;type&quot;</span><span class="hl-1">, </span><span class="hl-0">handler</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-2">return</span><span class="hl-1"> () </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-0">someEvent</span><span class="hl-1">.</span><span class="hl-6">off</span><span class="hl-1">(</span><span class="hl-3">&quot;type&quot;</span><span class="hl-1">, </span><span class="hl-0">handler</span><span class="hl-1">);</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-8">a</span><span class="hl-1"> = </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-6">A</span><span class="hl-1">();</span><br/><span class="hl-0">a</span><span class="hl-1">.</span><span class="hl-6">dispose</span><span class="hl-1">(); </span><span class="hl-4">// clear all disposers</span>
</code><button type="button">Copy</button></pre>

</li>
</ul>
<h3 id="refreshable" class="tsd-anchor-link">Refreshable<a href="#refreshable" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><ul>
<li>
<p>Disposables can bind to keys with <code>DisposableMap</code>. Setting a disposable with the same key will dispose (flush) the old one first.</p>
<pre><code class="js"><span class="hl-2">import</span><span class="hl-1"> { </span><span class="hl-0">disposableStore</span><span class="hl-1">, </span><span class="hl-0">disposableMap</span><span class="hl-1"> } </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&quot;@wopjs/disposable&quot;</span><span class="hl-1">;</span><br/><span class="hl-2">import</span><span class="hl-1"> { </span><span class="hl-0">addEventListener</span><span class="hl-1"> } </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&quot;@wopjs/dom&quot;</span><span class="hl-1">;</span><br/><span class="hl-2">import</span><span class="hl-1"> { </span><span class="hl-0">timeout</span><span class="hl-1"> } </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&quot;@wopjs/time&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-8">store</span><span class="hl-1"> = </span><span class="hl-6">disposableStore</span><span class="hl-1">();</span><br/><span class="hl-4">// let store also manage the DisposableMap</span><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-8">map</span><span class="hl-1"> = </span><span class="hl-0">store</span><span class="hl-1">.</span><span class="hl-6">add</span><span class="hl-1">(</span><span class="hl-6">disposableMap</span><span class="hl-1">());</span><br/><br/><span class="hl-0">store</span><span class="hl-1">.</span><span class="hl-6">add</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-6">addEventListener</span><span class="hl-1">(</span><span class="hl-0">window</span><span class="hl-1">, </span><span class="hl-3">&quot;click&quot;</span><span class="hl-1">, </span><span class="hl-0">event</span><span class="hl-1"> </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">// Clicking within 1s will trigger debounce effect (the pending timeout is cancelled before adding the new one).</span><br/><span class="hl-1">    </span><span class="hl-0">map</span><span class="hl-1">.</span><span class="hl-6">set</span><span class="hl-1">(</span><br/><span class="hl-1">      </span><span class="hl-3">&quot;myId&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-6">timeout</span><span class="hl-1">(() </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-0">event</span><span class="hl-1">), </span><span class="hl-9">1000</span><span class="hl-1">)</span><br/><span class="hl-1">    );</span><br/><span class="hl-1">  })</span><br/><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

</li>
</ul>
<h3 id="small-footprint" class="tsd-anchor-link">Small Footprint<a href="#small-footprint" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><ul>
<li>Designed and implemented with efficiency and ergonomics in mind, not only the (minified) bundle size is less than 1kb, using this library also enables patterns that require way less code to manage side effect disposers and module life-cycles.</li>
</ul>
<h2 id="concepts" class="tsd-anchor-link">Concepts<a href="#concepts" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><h3 id="disposable" class="tsd-anchor-link">Disposable<a href="#disposable" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>A disposable is an object that has a <code>dispose</code> method. The <code>dispose</code> method is used to dispose the object, which means to clean up any resources it holds.</p>
<pre><code class="js"><span class="hl-4">// class disposable</span><br/><span class="hl-5">class</span><span class="hl-1"> </span><span class="hl-7">MyDisposable</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-6">dispose</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">&quot;clean up&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-8">myDisposable</span><span class="hl-1"> = </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-6">MyDisposable</span><span class="hl-1">();</span><br/><br/><span class="hl-4">// plain object disposable</span><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-8">myDisposable</span><span class="hl-1"> = {</span><br/><span class="hl-1">  </span><span class="hl-6">dispose</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">&quot;clean up&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">};</span>
</code><button type="button">Copy</button></pre>

<h3 id="disposer" class="tsd-anchor-link">Disposer<a href="#disposer" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>A disposer is a function that cleans up resources. It is usually created by a factory function.</p>
<pre><code class="js"><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">addListener</span><span class="hl-1"> = (</span><span class="hl-0">target</span><span class="hl-1">, </span><span class="hl-0">type</span><span class="hl-1">, </span><span class="hl-0">listener</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">target</span><span class="hl-1">.</span><span class="hl-6">addEventListener</span><span class="hl-1">(</span><span class="hl-0">type</span><span class="hl-1">, </span><span class="hl-0">listener</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-4">// disposer function</span><br/><span class="hl-1">  </span><span class="hl-2">return</span><span class="hl-1"> () </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-0">target</span><span class="hl-1">.</span><span class="hl-6">removeEventListener</span><span class="hl-1">(</span><span class="hl-0">type</span><span class="hl-1">, </span><span class="hl-0">listener</span><span class="hl-1">);</span><br/><span class="hl-1">};</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-8">disposer</span><span class="hl-1"> = </span><span class="hl-6">addListener</span><span class="hl-1">(</span><span class="hl-0">window</span><span class="hl-1">, </span><span class="hl-3">&quot;click&quot;</span><span class="hl-1">, () </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">&quot;click&quot;</span><span class="hl-1">));</span><br/><br/><span class="hl-6">disposer</span><span class="hl-1">(); </span><span class="hl-4">// listener is removed</span>
</code><button type="button">Copy</button></pre>

<h3 id="disposabledisposer" class="tsd-anchor-link">DisposableDisposer<a href="#disposabledisposer" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>A disposable disposer is both a disposer an a disposable.</p>
<p>This pattern is useful if you want to create disposers that are compatible to more frameworks.</p>
<pre><code class="js"><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">addListener</span><span class="hl-1"> = (</span><span class="hl-0">target</span><span class="hl-1">, </span><span class="hl-0">type</span><span class="hl-1">, </span><span class="hl-0">listener</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">target</span><span class="hl-1">.</span><span class="hl-6">addEventListener</span><span class="hl-1">(</span><span class="hl-0">type</span><span class="hl-1">, </span><span class="hl-0">listener</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">disposer</span><span class="hl-1"> = () </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-0">target</span><span class="hl-1">.</span><span class="hl-6">removeEventListener</span><span class="hl-1">(</span><span class="hl-0">type</span><span class="hl-1">, </span><span class="hl-0">listener</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-0">disposer</span><span class="hl-1">.</span><span class="hl-0">dispose</span><span class="hl-1"> = </span><span class="hl-0">disposer</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-2">return</span><span class="hl-1"> </span><span class="hl-0">disposer</span><span class="hl-1">;</span><br/><span class="hl-1">};</span>
</code><button type="button">Copy</button></pre>

<p>For type annotation you may use <code>DisposableDisposer</code>:</p>
<pre><code class="ts"><span class="hl-2">import</span><span class="hl-1"> </span><span class="hl-2">type</span><span class="hl-1"> { </span><span class="hl-0">DisposableDisposer</span><span class="hl-1"> } </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&quot;@wopjs/disposable&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">setInterval</span><span class="hl-1"> = (</span><span class="hl-6">handler</span><span class="hl-1">: () </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-7">void</span><span class="hl-1">, </span><span class="hl-0">timeout</span><span class="hl-1">: </span><span class="hl-7">number</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-8">ticket</span><span class="hl-1"> = </span><span class="hl-6">setInterval</span><span class="hl-1">(</span><span class="hl-0">handler</span><span class="hl-1">, </span><span class="hl-0">timeout</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">disposer</span><span class="hl-1">: </span><span class="hl-7">DisposableDisposer</span><span class="hl-1"> = () </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-6">clearInterval</span><span class="hl-1">(</span><span class="hl-0">ticket</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-0">disposer</span><span class="hl-1">.</span><span class="hl-0">dispose</span><span class="hl-1"> = </span><span class="hl-0">disposer</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-2">return</span><span class="hl-1"> </span><span class="hl-0">disposer</span><span class="hl-1">;</span><br/><span class="hl-1">};</span>
</code><button type="button">Copy</button></pre>

<h3 id="disposablestore" class="tsd-anchor-link">DisposableStore<a href="#disposablestore" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>A DisposableStore is a <a href="#DisposableDisposer">DisposableDisposer</a> that manages other disposers and disposables.</p>
<pre><code class="js"><span class="hl-2">import</span><span class="hl-1"> { </span><span class="hl-0">disposableStore</span><span class="hl-1"> } </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&quot;@wopjs/disposable&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-8">dispose</span><span class="hl-1"> = </span><span class="hl-6">disposableStore</span><span class="hl-1">();</span><br/><span class="hl-0">dispose</span><span class="hl-1">.</span><span class="hl-6">add</span><span class="hl-1">(() </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">&quot;disposed 1&quot;</span><span class="hl-1">));</span><br/><span class="hl-0">dispose</span><span class="hl-1">.</span><span class="hl-6">add</span><span class="hl-1">(() </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">&quot;disposed 2&quot;</span><span class="hl-1">));</span><br/><span class="hl-0">dispose</span><span class="hl-1">.</span><span class="hl-6">make</span><span class="hl-1">(() </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">return</span><span class="hl-1"> () </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">&quot;disposed 3&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">});</span><br/><span class="hl-6">dispose</span><span class="hl-1">(); </span><span class="hl-4">// Logs &quot;dispose 1&quot;, &quot;dispose 2&quot; and &quot;dispose 3&quot;</span>
</code><button type="button">Copy</button></pre>

<p>Since it is also a disposer, it can be easily composed with other disposables.</p>
<pre><code class="ts"><span class="hl-2">import</span><span class="hl-1"> { </span><span class="hl-0">disposableStore</span><span class="hl-1">, </span><span class="hl-2">type</span><span class="hl-1"> </span><span class="hl-0">IDisposable</span><span class="hl-1"> } </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&quot;@wopjs/disposable&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">class</span><span class="hl-1"> </span><span class="hl-7">A</span><span class="hl-1"> </span><span class="hl-5">implements</span><span class="hl-1"> </span><span class="hl-7">IDisposable</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">dispose</span><span class="hl-1"> = </span><span class="hl-6">disposableStore</span><span class="hl-1">();</span><br/><span class="hl-1">  </span><span class="hl-5">constructor</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-5">this</span><span class="hl-1">.</span><span class="hl-0">dispose</span><span class="hl-1">.</span><span class="hl-6">add</span><span class="hl-1">(() </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">&quot;a&quot;</span><span class="hl-1">));</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">  </span><span class="hl-6">print</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">&quot;print a&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">class</span><span class="hl-1"> </span><span class="hl-7">B</span><span class="hl-1"> </span><span class="hl-5">implements</span><span class="hl-1"> </span><span class="hl-7">IDisposable</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">dispose</span><span class="hl-1"> = </span><span class="hl-6">disposableStore</span><span class="hl-1">();</span><br/><span class="hl-1">  </span><span class="hl-0">a</span><span class="hl-1"> = </span><span class="hl-5">this</span><span class="hl-1">.</span><span class="hl-0">dispose</span><span class="hl-1">.</span><span class="hl-6">add</span><span class="hl-1">(</span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-6">A</span><span class="hl-1">());</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-8">b</span><span class="hl-1"> = </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-6">B</span><span class="hl-1">();</span><br/><span class="hl-0">b</span><span class="hl-1">.</span><span class="hl-0">a</span><span class="hl-1">.</span><span class="hl-6">print</span><span class="hl-1">(); </span><span class="hl-4">// &quot;print a&quot;</span><br/><span class="hl-0">b</span><span class="hl-1">.</span><span class="hl-6">dispose</span><span class="hl-1">(); </span><span class="hl-4">// both a and b are disposed</span>
</code><button type="button">Copy</button></pre>

<h3 id="disposablemap" class="tsd-anchor-link">DisposableMap<a href="#disposablemap" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Like <a href="#disposablestore">DisposableStore</a>, a DisposableMap is a <a href="#DisposableDisposer">DisposableDisposer</a> that manages disposers and disposables with key.</p>
<p>Map key introduces <a href="#refreshable">Refreshable</a> which makes it more interesting when comes to creating side effects on the fly.</p>
<pre><code class="js"><span class="hl-2">import</span><span class="hl-1"> { </span><span class="hl-0">disposableMap</span><span class="hl-1"> } </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&quot;@wopjs/disposable&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-8">dispose</span><span class="hl-1"> = </span><span class="hl-6">disposableMap</span><span class="hl-1">();</span><br/><span class="hl-0">dispose</span><span class="hl-1">.</span><span class="hl-6">set</span><span class="hl-1">(</span><span class="hl-3">&quot;key1&quot;</span><span class="hl-1">, () </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">&quot;disposed 1&quot;</span><span class="hl-1">));</span><br/><span class="hl-0">dispose</span><span class="hl-1">.</span><span class="hl-6">make</span><span class="hl-1">(</span><span class="hl-3">&quot;key2&quot;</span><span class="hl-1">, () </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">return</span><span class="hl-1"> () </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">&quot;disposed 2&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">});</span><br/><span class="hl-6">dispose</span><span class="hl-1">(); </span><span class="hl-4">// Logs &quot;disposed 1&quot; and &quot;disposed 2&quot;</span>
</code><button type="button">Copy</button></pre>

<p>Since it is also a disposer, it can be easily composed with other disposables.</p>
<pre><code class="ts"><span class="hl-2">import</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">disposableMap</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">disposableStore</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-2">type</span><span class="hl-1"> </span><span class="hl-0">IDisposable</span><span class="hl-1">,</span><br/><span class="hl-1">} </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&quot;@wopjs/disposable&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">class</span><span class="hl-1"> </span><span class="hl-7">A</span><span class="hl-1"> </span><span class="hl-5">implements</span><span class="hl-1"> </span><span class="hl-7">IDisposable</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">dispose</span><span class="hl-1"> = </span><span class="hl-6">disposableMap</span><span class="hl-1">();</span><br/><span class="hl-1">  </span><span class="hl-5">constructor</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-5">this</span><span class="hl-1">.</span><span class="hl-0">dispose</span><span class="hl-1">.</span><span class="hl-6">add</span><span class="hl-1">(</span><span class="hl-3">&quot;key1&quot;</span><span class="hl-1">, () </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">&quot;a&quot;</span><span class="hl-1">));</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">  </span><span class="hl-6">print</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">&quot;print a&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">class</span><span class="hl-1"> </span><span class="hl-7">B</span><span class="hl-1"> </span><span class="hl-5">implements</span><span class="hl-1"> </span><span class="hl-7">IDisposable</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">dispose</span><span class="hl-1"> = </span><span class="hl-6">disposableStore</span><span class="hl-1">();</span><br/><span class="hl-1">  </span><span class="hl-0">a</span><span class="hl-1"> = </span><span class="hl-5">this</span><span class="hl-1">.</span><span class="hl-0">dispose</span><span class="hl-1">.</span><span class="hl-6">add</span><span class="hl-1">(</span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-6">A</span><span class="hl-1">());</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-8">b</span><span class="hl-1"> = </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-6">B</span><span class="hl-1">();</span><br/><span class="hl-0">b</span><span class="hl-1">.</span><span class="hl-0">a</span><span class="hl-1">.</span><span class="hl-6">print</span><span class="hl-1">(); </span><span class="hl-4">// &quot;print a&quot;</span><br/><span class="hl-0">b</span><span class="hl-1">.</span><span class="hl-6">dispose</span><span class="hl-1">(); </span><span class="hl-4">// both a and b are disposed</span>
</code><button type="button">Copy</button></pre>

<h3 id="disposableone" class="tsd-anchor-link">DisposableOne<a href="#disposableone" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>DisposableOne is a lightweight <a href="#DisposableMap">DisposableMap</a>. It only manages one disposer or disposable at a time. It is useful if you want <a href="#refreshable">Refreshable</a> but only need to manage one disposer or disposable.</p>
<pre><code class="js"><span class="hl-2">import</span><span class="hl-1"> { </span><span class="hl-0">disposableOne</span><span class="hl-1"> } </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&quot;@wopjs/disposable&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-8">dispose</span><span class="hl-1"> = </span><span class="hl-6">disposableOne</span><span class="hl-1">();</span><br/><br/><span class="hl-0">dispose</span><span class="hl-1">.</span><span class="hl-6">set</span><span class="hl-1">(() </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">&quot;disposed 1&quot;</span><span class="hl-1">));</span><br/><br/><span class="hl-0">dispose</span><span class="hl-1">.</span><span class="hl-6">set</span><span class="hl-1">(() </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">&quot;disposed 2&quot;</span><span class="hl-1">)); </span><span class="hl-4">// Logs &quot;disposed 1&quot;</span><br/><br/><span class="hl-6">dispose</span><span class="hl-1">(); </span><span class="hl-4">// Logs &quot;disposed 2&quot;</span>
</code><button type="button">Copy</button></pre>

<h3 id="abortable" class="tsd-anchor-link">Abortable<a href="#abortable" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Abortable is a special kind of disposable that may be disposed outside of the store (like when <code>setTimeout</code> or <code>once</code> event finishes). It will notify the store to delete itself from the store when disposed. The signature is the same as a disposable disposer.</p>
<pre><code class="js"><span class="hl-2">import</span><span class="hl-1"> { </span><span class="hl-0">abortable</span><span class="hl-1">, </span><span class="hl-0">disposableStore</span><span class="hl-1"> } </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&quot;@wopjs/disposable&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">timeout</span><span class="hl-1"> = (</span><span class="hl-0">handle</span><span class="hl-1">, </span><span class="hl-0">timeout</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">let</span><span class="hl-1"> </span><span class="hl-0">id</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-8">disposer</span><span class="hl-1"> = </span><span class="hl-6">abortable</span><span class="hl-1">(() </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-6">clearTimeout</span><span class="hl-1">(</span><span class="hl-0">id</span><span class="hl-1">));</span><br/><span class="hl-1">  </span><span class="hl-0">id</span><span class="hl-1"> = </span><span class="hl-6">setTimeout</span><span class="hl-1">(() </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">handler</span><span class="hl-1">();</span><br/><span class="hl-1">    </span><span class="hl-6">disposer</span><span class="hl-1">();</span><br/><span class="hl-1">  }, </span><span class="hl-0">timeout</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-2">return</span><span class="hl-1"> </span><span class="hl-0">disposer</span><span class="hl-1">;</span><br/><span class="hl-1">};</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-8">dispose</span><span class="hl-1"> = </span><span class="hl-6">disposableStore</span><span class="hl-1">();</span><br/><span class="hl-0">dispose</span><span class="hl-1">.</span><span class="hl-6">add</span><span class="hl-1">(</span><span class="hl-6">timeout</span><span class="hl-1">(() </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">&quot;timeout&quot;</span><span class="hl-1">), </span><span class="hl-9">1000</span><span class="hl-1">));</span><br/><br/><span class="hl-4">// The `timeout` disposer will be removed from the `dispose` after 1s.</span>
</code><button type="button">Copy</button></pre>

<h2 id="eslint-plugin" class="tsd-anchor-link">Eslint Plugin<a href="#eslint-plugin" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>This package comes with a eslint plugin:</p>
<pre><code><span class="hl-4">// eslint.config.mjs</span><br/><span class="hl-2">import</span><span class="hl-1"> </span><span class="hl-0">disposable</span><span class="hl-1"> </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&quot;@wopjs/disposable/eslint-plugin.js&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-2">export</span><span class="hl-1"> </span><span class="hl-2">default</span><span class="hl-1"> [</span><br/><span class="hl-1">  </span><span class="hl-0">disposable</span><span class="hl-1">.</span><span class="hl-0">recommended</span><br/><span class="hl-1">]</span>
</code><button>Copy</button></pre>

<p>Rules:</p>
<ul>
<li><code>disposable/readonly-dispose</code>: Enforce <code>dispose</code> method to be <code>readonly</code>.</li>
</ul>
<h2 id="license" class="tsd-anchor-link">License<a href="#license" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>MIT @ <a href="https://github.com/wopjs">wopjs</a></p>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-chevronDown"></use></svg><h3>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-chevronDown"></use></svg><h3>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#wopjsdisposable"><span>@wopjs/disposable</span></a><ul><li><a href="#install"><span>Install</span></a></li><li><a href="#examples"><span>Examples</span></a></li><li><a href="#features"><span>Features</span></a></li><li><ul><li><a href="#non-invasive"><span>Non-<wbr/>invasive</span></a></li><li><a href="#compact"><span>Compact</span></a></li><li><a href="#refreshable"><span>Refreshable</span></a></li><li><a href="#small-footprint"><span>Small <wbr/>Footprint</span></a></li></ul></li><li><a href="#concepts"><span>Concepts</span></a></li><li><ul><li><a href="#disposable"><span>Disposable</span></a></li><li><a href="#disposer"><span>Disposer</span></a></li><li><a href="#disposabledisposer"><span>Disposable<wbr/>Disposer</span></a></li><li><a href="#disposablestore"><span>Disposable<wbr/>Store</span></a></li><li><a href="#disposablemap"><span>Disposable<wbr/>Map</span></a></li><li><a href="#disposableone"><span>Disposable<wbr/>One</span></a></li><li><a href="#abortable"><span>Abortable</span></a></li></ul></li><li><a href="#eslint-plugin"><span>Eslint <wbr/>Plugin</span></a></li><li><a href="#license"><span>License</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="modules.html">@wopjs/disposable - v0.1.19</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer></footer><div class="overlay"></div></body></html>
